<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>모든 지갑은 코어위브와 함께</title>
    <link rel="stylesheet" href="./styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="app">
      <!-- Top Navigation Bar -->
      <header class="top-navbar glass">
        <div class="navbar-container">
          <div class="logo-horizontal">
            <div class="logo-mark">N</div>
            <div class="logo-text">
              <span class="brand">CoreWeave</span>
              <span class="tagline">기관급 스테이킹 데스크</span>
            </div>
          </div>

          <nav class="nav-horizontal">
            <button class="nav-item-horizontal active" data-page="dashboard">
              대시보드
            </button>
            <button class="nav-item-horizontal" data-page="pools">
              스테이킹 풀
            </button>
            <button class="nav-item-horizontal" data-page="rewards">
              리워드 내역
            </button>
            <button class="nav-item-horizontal" data-page="signup">
              회원가입
            </button>
          </nav>

          <div class="navbar-actions">
            <div class="theme-toggle" id="themeToggle" title="라이트/다크 모드 전환">
              <span class="theme-icon" id="themeIcon">☾</span>
            </div>
            <button class="btn-outline" id="networkBtn">이더리움 메인넷</button>
            <button class="btn-outline" id="adminBtn" style="display:none;">🔐 어드민</button>
            <button class="btn-outline" id="loginBtn">로그인</button>
            <button class="btn-primary" id="walletBtn">지갑 연결</button>
          </div>
        </div>
      </header>

      <!-- Main Content -->
      <main class="main-content">

        <!-- 로그인 전 환영 히어로 -->
        <section class="card glass pre-login-welcome" style="position:relative;padding:80px 48px;margin:0;min-height:600px;overflow:hidden;border-radius:0 0 var(--radius-lg) var(--radius-lg);border-top:none;">
          <div style="max-width:580px;">
            <p style="font-size:14px;font-weight:600;color:#a855f7;text-transform:uppercase;letter-spacing:1px;margin-bottom:16px;">코어위브 스테이킹</p>
            <h1 style="font-size:48px;font-weight:700;line-height:1.2;margin-bottom:24px;">
              코어위브와 함께하는<br/>
              <span style="background:linear-gradient(135deg, #6366f1 0%, #a855f7 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;">즐거운 스테이킹</span>
            </h1>
            <p style="font-size:18px;color:#64748b;margin-bottom:32px;line-height:1.6;">
              검증된 스테이킹 풀과 실시간 모니터링으로<br/>
              안정적이고 투명한 수익을 창출하세요.
            </p>
            <div style="display:flex;gap:16px;align-items:center;">
              <button class="btn-primary" onclick="document.querySelector('#loginBtn').click();" style="padding:16px 32px;font-size:16px;font-weight:600;">
                시작하기
              </button>
              <div style="display:flex;gap:12px;">
                <span class="badge badge-muted">멀티체인 포트폴리오</span>
                <span class="badge badge-muted">실시간 리워드</span>
              </div>
            </div>
          </div>
          <div class="person-image" style="position:absolute;top:0;right:80px;height:720px;display:flex;align-items:flex-end;justify-content:center;z-index:10;margin-top:12px;">
            <img src="./profile.png" alt="코어위브 스테이킹" style="height:120%;width:auto;object-fit:contain;filter:drop-shadow(0 25px 50px rgba(99, 102, 241, 0.3)) contrast(1.2) saturate(0.75) hue-rotate(-12deg) brightness(1.05) sepia(0.1) invert(0.02);transform:scale(0.88);image-rendering:high-quality;-webkit-mask-image:radial-gradient(ellipse 100% 100% at center, black 100%, transparent 100%);mask-image:radial-gradient(ellipse 100% 100% at center, black 100%, transparent 100%);mix-blend-mode:normal;isolation:isolate;outline:none;border:none;" />
          </div>
          <!-- CoreWeave Logo -->
          <div style="position:absolute;top:240px;right:190px;z-index:999;">
            <img src="./sim.png" alt="CoreWeave" style="width:330px;height:auto;filter:none;box-shadow:none;transform:translateX(-210px) translateY(-200px);" />
          </div>
        </section>

        <!-- Overview cards (로그인 후에만 표시) -->
        <section class="grid grid-3 overview auth-required" style="display:none;">
          <article class="card glass">
            <div class="card-header">
              <span class="card-label">총 스테이킹 자산</span>
              <span class="pill pill-green">+12.4% 30D</span>
            </div>
            <div class="card-main">
              <div class="value-large" id="totalStaked">$24,320.00</div>
              <div class="value-sub">3 Assets · 3 Pools</div>
            </div>
          </article>

          <article class="card glass">
            <div class="card-header">
              <span class="card-label">예상 연간 수익 (APY)</span>
              <span class="pill pill-blue">실시간 시뮬레이션</span>
            </div>
            <div class="card-main">
              <div class="value-large" id="estApy">8.9%</div>
              <div class="progress-bar">
                <div class="progress-fill" id="apyProgress"></div>
              </div>
            </div>
          </article>

          <article class="card glass">
            <div class="card-header">
              <span class="card-label">미지급 리워드</span>
              <span class="pill pill-purple">Claim 가능</span>
            </div>
            <div class="card-main">
              <div class="value-large" id="pendingRewards">152.94</div>
              <div class="value-sub">NOVA · 지난 24시간 +4.2%</div>
            </div>
          </article>
        </section>

        <!-- Content -->
        <section class="grid grid-2 content-section">
          <!-- Left: Portfolio breakdown (로그인 후에만 표시) -->
          <section class="card glass auth-required" style="display:none;">
            <div class="card-header">
              <div>
                <h2 class="card-title">포트폴리오 구성</h2>
                <p class="card-subtitle">
                  체인 별 · 자산 별 스테이킹 비율을 한 눈에 확인하세요.
                </p>
              </div>
              <select class="select" id="timeRangeSelect">
                <option value="7d">최근 7일</option>
                <option value="30d" selected>최근 30일</option>
                <option value="90d">최근 90일</option>
              </select>
            </div>

            <div class="portfolio">
              <div class="donut-wrapper">
                <div class="donut" id="donutChart">
                  <div class="donut-center">
                    <span class="donut-value">100%</span>
                    <span class="donut-label">Staked</span>
                  </div>
                </div>
              </div>
              <div class="portfolio-list" id="portfolioList">
                <!-- Filled by JS -->
              </div>
            </div>
          </section>

          <!-- Right: Staking Pools and Rewards Calculator Container -->
          <div class="pools-rewards-container" style="max-width:100%;display:grid;grid-template-columns:1fr 1fr;gap:24px;">
            <!-- Staking pools -->
            <section class="card glass">
              <div class="card-header">
                <div>
                  <h2 class="card-title">스테이킹 풀</h2>
                  <p class="card-subtitle">
                    검증된 스테이킹 풀에서 안정적인 수익을 창출하세요.
                  </p>
                </div>
                <div class="tabs">
                  <button class="tab active" data-filter="all">전체</button>
                  <button class="tab" data-filter="stable">스테이블</button>
                  <button class="tab" data-filter="volatile">변동성</button>
                </div>
              </div>

              <div class="pool-list" id="poolList">
                <!-- Filled by JS -->
              </div>
            </section>

            <!-- Rewards Calculator -->
            <section class="card glass">
              <div class="card-header">
                <h2 class="card-title">리워드 계산기</h2>
                <p class="card-subtitle">
                  선택한 풀의 APY 기준으로 예상 리워드를 계산합니다.
                </p>
              </div>

              <div class="reward-sim">
                <div class="form-group">
                  <label for="simAmount">스테이킹 금액 (USD 환산)</label>
                  <input
                    type="number"
                    id="simAmount"
                    class="input"
                    placeholder="예: 1000"
                    min="0"
                  />
                </div>
                <div class="form-group">
                  <label for="simDays">기간 (일)</label>
                  <input
                    type="number"
                    id="simDays"
                    class="input"
                    placeholder="예: 365"
                    min="1"
                  />
                </div>
                <div class="form-group">
                  <label for="simApy">APY (%)</label>
                  <input
                    type="number"
                    id="simApy"
                    class="input"
                    placeholder="예: 8.5"
                    min="0"
                    step="0.1"
                  />
                </div>

                <button class="btn-primary w-full" id="simBtn">리워드 계산</button>

                <div class="sim-result" id="simResult">
                  예상 리워드 계산 결과가 여기 표시됩니다.
                </div>
              </div>
            </section>
          </div>
        </section>

        <!-- Bottom section: activity -->
        <section class="content-section">
          <!-- Activity (로그인 후에만 표시) -->
          <section class="card glass auth-required" style="display:none;">
            <div class="card-header">
              <h2 class="card-title">트랜잭션 히스토리</h2>
              <p class="card-subtitle">
                최근 스테이킹 및 언스테이킹 내역을 확인하세요.
              </p>
            </div>
            <div class="activity-list" id="activityList">
              <!-- Filled by JS -->
            </div>
          </section>
        </section>

        <!-- 리워드 내역 페이지 -->
        <section class="page-section" id="rewards-page" style="display:none;">
          <div class="card glass" style="margin-bottom:32px;">
            <div class="card-header">
              <h2 class="card-title">리워드 내역</h2>
              <p class="card-subtitle">
                스테이킹을 통해 받은 모든 리워드 내역을 확인하세요.
              </p>
            </div>
          </div>

          <!-- 리워드 통계 카드 -->
          <div class="grid grid-3" style="margin-bottom:32px;">
            <article class="card glass">
              <div class="card-header">
                <span class="card-label">총 리워드 수령액</span>
              </div>
              <div class="value-group">
                <h3 class="card-value" id="totalRewardsUSD">$0</h3>
              </div>
            </article>
            <article class="card glass">
              <div class="card-header">
                <span class="card-label">이번 달 리워드</span>
              </div>
              <div class="value-group">
                <h3 class="card-value" id="monthRewardsUSD">$0</h3>
              </div>
            </article>
            <article class="card glass">
              <div class="card-header">
                <span class="card-label">평균 APY</span>
              </div>
              <div class="value-group">
                <h3 class="card-value" id="avgAPY">0%</h3>
              </div>
            </article>
          </div>

          <!-- 리워드 내역 테이블 -->
          <section class="card glass">
            <div class="card-header">
              <h2 class="card-title">상세 내역</h2>
              <div style="display:flex;gap:12px;">
                <select class="input" id="rewardFilterCoin" style="width:150px;">
                  <option value="all">모든 코인</option>
                  <option value="BTC">비트코인 (BTC)</option>
                  <option value="ETH">이더리움 (ETH)</option>
                  <option value="XRP">리플 (XRP)</option>
                </select>
                <select class="input" id="rewardFilterPeriod" style="width:150px;">
                  <option value="all">전체 기간</option>
                  <option value="week">최근 1주일</option>
                  <option value="month">최근 1개월</option>
                  <option value="year">최근 1년</option>
                </select>
              </div>
            </div>
            <div class="rewards-table">
              <table style="width:100%;border-collapse:collapse;">
                <thead>
                  <tr style="border-bottom:1px solid var(--border);text-align:left;">
                    <th style="padding:16px;font-weight:600;color:var(--text-muted);">날짜</th>
                    <th style="padding:16px;font-weight:600;color:var(--text-muted);">코인</th>
                    <th style="padding:16px;font-weight:600;color:var(--text-muted);">수량</th>
                    <th style="padding:16px;font-weight:600;color:var(--text-muted);">USD 환산</th>
                    <th style="padding:16px;font-weight:600;color:var(--text-muted);">APY</th>
                    <th style="padding:16px;font-weight:600;color:var(--text-muted);">상태</th>
                  </tr>
                </thead>
                <tbody id="rewardsTableBody">
                  <!-- Filled by JS -->
                </tbody>
              </table>
            </div>
          </section>
        </section>

        <!-- 회원가입 페이지 -->
        <section class="page-section" id="signup-page" style="display:none;">
          <div class="card glass" style="max-width:600px;margin:0 auto;">
            <div class="card-header" style="text-align:center;margin-bottom:32px;">
              <h2 class="card-title" style="font-size:32px;margin-bottom:12px;">회원가입</h2>
              <p class="card-subtitle">
                코어위브 스테이킹에 오신 것을 환영합니다!<br/>
                아래 정보를 입력하여 계정을 생성하세요.
              </p>
            </div>

            <form id="signupForm" style="padding:0 24px 24px;">
              <div class="form-group" style="margin-bottom:24px;">
                <label for="signupEmail" style="display:block;margin-bottom:8px;font-weight:600;color:var(--text);">이메일</label>
                <input
                  type="email"
                  id="signupEmail"
                  class="input"
                  placeholder="example@email.com"
                  required
                  style="width:100%;"
                />
              </div>

              <div class="form-group" style="margin-bottom:24px;">
                <label for="signupPassword" style="display:block;margin-bottom:8px;font-weight:600;color:var(--text);">비밀번호</label>
                <input
                  type="password"
                  id="signupPassword"
                  class="input"
                  placeholder="최소 6자 이상"
                  required
                  style="width:100%;"
                />
                <small style="display:block;margin-top:6px;color:var(--text-muted);font-size:13px;">
                  영문, 숫자를 포함하여 6자 이상 입력하세요.
                </small>
              </div>

              <div class="form-group" style="margin-bottom:24px;">
                <label for="signupPasswordConfirm" style="display:block;margin-bottom:8px;font-weight:600;color:var(--text);">비밀번호 확인</label>
                <input
                  type="password"
                  id="signupPasswordConfirm"
                  class="input"
                  placeholder="비밀번호를 다시 입력하세요"
                  required
                  style="width:100%;"
                />
              </div>

              <div class="form-group" style="margin-bottom:24px;">
                <label for="signupName" style="display:block;margin-bottom:8px;font-weight:600;color:var(--text);">이름 (선택)</label>
                <input
                  type="text"
                  id="signupName"
                  class="input"
                  placeholder="홍길동"
                  style="width:100%;"
                />
              </div>

              <div class="form-group" style="margin-bottom:32px;">
                <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
                  <input type="checkbox" id="signupAgree" required />
                  <span style="font-size:14px;color:var(--text);">
                    <a href="#" style="color:#6366f1;text-decoration:underline;">이용약관</a> 및 
                    <a href="#" style="color:#6366f1;text-decoration:underline;">개인정보처리방침</a>에 동의합니다.
                  </span>
                </label>
              </div>

              <button type="submit" class="btn-primary w-full" style="padding:16px;font-size:16px;font-weight:600;">
                회원가입
              </button>

              <p style="text-align:center;margin-top:24px;color:var(--text-muted);font-size:14px;">
                이미 계정이 있으신가요? 
                <button type="button" class="link-btn" id="goToLogin" style="color:#6366f1;font-weight:600;background:none;border:none;cursor:pointer;text-decoration:underline;">
                  로그인
                </button>
              </p>
            </form>
          </div>
        </section>

        <!-- Trust / footer section -->
          <div class="footer-left">
            <h2 class="footer-title">안전하고 투명한 스테이킹</h2>
            <p class="footer-subtitle">
              NovaStake는 <strong>기관급 보안</strong>과 투명한 운영을 통해
              고객 자산을 안전하게 보호합니다.
            </p>
            <ul class="footer-list">
              <li>· 멀티체인 지원으로 포트폴리오 다각화</li>
              <li>· 검증된 스테이킹 풀만 엄선하여 제공</li>
              <li>· 실시간 TVL, Lock-up, 리스크 정보 제공</li>
              <li>· 24/7 고객 지원 및 모니터링 시스템</li>
            </ul>
          </div>
          <div class="footer-right">
            <div class="glass footer-card">
              <p class="footer-card-title">왜 NovaStake인가?</p>
              <p class="footer-card-text">
                기관 투자자부터 개인 투자자까지, 누구나 쉽고 안전하게
                <strong>스테이킹 수익을 창출</strong>할 수 있는 플랫폼입니다.
              </p>
              <p class="footer-card-text">
                직관적인 대시보드와 상세한 분석 도구로 최적의 투자 결정을 지원합니다.
              </p>
            </div>
          </div>
        </section>
      </main>
    </div>

    <!-- Staking modal -->
    <div class="modal-backdrop" id="stakeModal">
      <div class="modal glass">
        <div class="modal-header">
          <h2 class="modal-title" id="modalTitle">스테이킹</h2>
          <button class="modal-close" id="modalCloseBtn">✕</button>
        </div>
        <div class="modal-body">
          <div class="modal-pool-info" id="modalPoolInfo">
            <!-- Filled by JS -->
          </div>
          <div class="form-group">
            <label for="stakeAmount">스테이킹 수량</label>
            <input
              type="number"
              id="stakeAmount"
              class="input"
              placeholder="예: 10.5"
              min="0"
            />
            <div class="form-helper" id="stakeHelper"></div>
          </div>
          <button class="btn-primary w-full" id="stakeConfirmBtn">
            스테이킹 실행
          </button>
          <p class="modal-footnote">
            스테이킹이 완료되면 대시보드에 즉시 반영됩니다.
          </p>
        </div>
      </div>
    </div>

    <!-- Login modal -->
    <div class="modal-backdrop" id="loginModal">
      <div class="modal glass">
        <div class="modal-header">
          <h2 class="modal-title" id="loginModalTitle">로그인</h2>
          <button class="modal-close" id="loginCloseBtn">✕</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="loginEmail">이메일</label>
            <input
              type="email"
              id="loginEmail"
              class="input"
              placeholder="예: user@example.com"
            />
          </div>
          <div class="form-group">
            <label for="loginPassword">비밀번호</label>
            <input
              type="password"
              id="loginPassword"
              class="input"
              placeholder="4자 이상 비밀번호를 입력하세요"
            />
            <div class="form-helper">
              포트폴리오 데모용으로, 비밀번호는 브라우저 내부에만 저장되며 실제 인증은
              이루어지지 않습니다.
            </div>
          </div>
          <button class="btn-primary w-full" id="loginConfirmBtn">로그인</button>
          <p class="modal-footnote" id="loginStatusText"></p>
          <div class="auth-switch">
            <span id="toSignup" class="auth-switch-link">처음이신가요? 회원가입</span>
            <span id="toLogin" class="auth-switch-link auth-switch-link--hidden"
              >이미 계정이 있나요? 로그인</span
            >
          </div>
        </div>
      </div>
    </div>

    <!-- Admin Dashboard Modal -->
    <div class="modal-backdrop" id="adminModal">
      <div class="modal glass" style="max-width: 900px;">
        <div class="modal-header">
          <h2 class="modal-title">🔐 어드민 대시보드</h2>
          <button class="modal-close" id="adminCloseBtn">✕</button>
        </div>
        <div class="modal-body">
          <p style="font-size: 13px; color: #9ca3af; margin-bottom: 16px;">
            전체 유저의 스테이킹 데이터를 조회합니다. (Firestore 기반)
          </p>
          <div id="adminContent" style="max-height: 400px; overflow-y: auto;">
            <!-- Filled by JS -->
          </div>
        </div>
      </div>
    </div>

    <!-- Firebase core (Auth/Firestore/Analytics) 초기화 -->
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js';
      import { getAnalytics } from 'https://www.gstatic.com/firebasejs/12.6.0/firebase-analytics.js';
      import {
        getAuth,
        createUserWithEmailAndPassword,
        signInWithEmailAndPassword,
        signOut,
        onAuthStateChanged,
      } from 'https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js';
      import {
        getFirestore,
        doc,
        getDoc,
        setDoc,
        updateDoc,
      } from 'https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js';

      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: 'AIzaSyBvb8p8PFmeIh3ZVyWqWk1RQLBZyAUpfk4',
        authDomain: 'j22j22.firebaseapp.com',
        projectId: 'j22j22',
        storageBucket: 'j22j22.firebasestorage.app',
        messagingSenderId: '874202688810',
        appId: '1:874202688810:web:d384f6ea7cc4dcfb0b4253',
        measurementId: 'G-2BEJP8J1VT',
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      getAnalytics(app);

      const auth = getAuth(app);
      const db = getFirestore(app);

      // 나중에 Auth/Firestore 연동 시 재사용할 수 있도록 전역에 노출
      window.__firebase = {
        app,
        auth,
        db,
        createUserWithEmailAndPassword,
        signInWithEmailAndPassword,
        signOut,
        onAuthStateChanged,
        doc,
        getDoc,
        setDoc,
        updateDoc,
      };
    </script>

    <script src="./script.js"></script>
  </body>
</html>


